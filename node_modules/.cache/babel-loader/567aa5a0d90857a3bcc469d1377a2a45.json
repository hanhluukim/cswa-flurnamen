{"ast":null,"code":"import _regeneratorRuntime from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";//Infornation von APIs\nvar token=\"cmVzdGFwaS1yZWFkOmRlMjgxMjMyOGIzYTZmODc1NDIyYjM4NzZlMDJiZTM3\";var authHeader={'Authorization':\"Basic \".concat(token)};var API_URL='https://collections.thulb.uni-jena.de/api/v1';var keys=['title','area','evidence','note','parent'];/*\nAus der Daten werden nur folgende Funktionen eines Ergebnises gespeichert.\n*/var getImage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(objectID){var imgReq,imgL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:imgReq=\"https://collections.thulb.uni-jena.de/api/v1/objects/\"+objectID;imgL=[];_context.next=4;return axios.get(imgReq,{headers:authHeader}).then(function(response){var xml2js=require('react-native-xml2js');var parser=new xml2js.Parser();var dataJS='';parser.parseString(response.data,function(err,detailJSON){dataJS=detailJSON.mycoreobject;});try{imgL=dataJS.structure[0].derobjects[0].derobject;}catch(_unused){}});case 4:console.log(\"test image\");console.log(imgL);return _context.abrupt(\"return\",imgL);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getImage(_x){return _ref.apply(this,arguments);};}();function getResultsList(_x2){return _getResultsList.apply(this,arguments);}function _getResultsList(){_getResultsList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data){var foundObjects,i,len,new_data,objectID,imgL,COLLECTION_URL,VIEW_URL,TIF;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:foundObjects=[];i=0;case 2:if(!(i<data.length)){_context4.next=18;break;}len=0;if(data[i]['link']!=null){len=data[i]['link'].length;}new_data={'id':data[i]['id'],'title':data[i]['title'][0],'place':data[i]['place'][0],'gnd':data[i]['gnd'],'link':data[i]['link'],'len':len,'facetObjectType':data[i]['facetObjectType'],\"search_result_link_text\":data[i][\"search_result_link_text\"],'ArchFile_class_001_Label':data[i]['ArchFile_class_001_Label'][1],'collection':'','img':''};objectID=new_data['id'];imgL=[];_context4.next=10;return getImage(objectID);case 10:imgL=_context4.sent;/*.then(function (res){\n              console.log(\"in function get imageeee\");\n              \n              imgL = res;\n              console.log(imgL);\n              \n            });\n            */if(imgL.length!=0){console.log(\"outside of function\");console.log(imgL[0]);//.$[\"xlink:href\"]\nCOLLECTION_URL=\"https://collections.thulb.uni-jena.de/rsc/viewer/\";//HisBest_derivate_00024139/Flurnamen_Erfurt_Arnstadt_4605.tif\nVIEW_URL='https://collections.thulb.uni-jena.de/servlets/MCRTileCombineServlet/MID/';TIF=imgL[0].maindoc[0];new_data['img']=VIEW_URL+imgL[0].$[\"xlink:href\"]+\"/\"+TIF;new_data['collection']=COLLECTION_URL+imgL[0].$[\"xlink:href\"]+\"/\"+TIF;}console.log(\"adding to new data\");console.log(new_data.img);foundObjects.push(new_data);case 15:i++;_context4.next=2;break;case 18:return _context4.abrupt(\"return\",foundObjects);case 19:case\"end\":return _context4.stop();}}},_callee4);}));return _getResultsList.apply(this,arguments);};/*\nFunktion zum Aufrufen der Daten mit dem gegebenen Title.\nReturn bereits in JSON\nErgebnisse für gesuchten Title werden an Search Komponent gesendet\n*/var searchInfoQuery=function searchInfoQuery(title,filter){console.log(\"search option: \"+filter);if(filter==\"0\"){var req=API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND title:'+title;return axios.get(req,{headers:authHeader}).then(function(response){var data=response.data.response.docs;//docs is a list\nvar resp_in_list=getResultsList(data);return resp_in_list;});}if(filter==\"1\"){var req_flurname=API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND facetObjectType:\"Flurkarte\" AND title:'+title;return axios.get(req_flurname,{headers:authHeader}).then(function(response){var data=response.data.response.docs;//docs is a list\nvar resp_in_list=getResultsList(data);return resp_in_list;});}if(filter==\"2\"){var req_gemarkung=API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND facetObjectType:\"Gemarkung\" AND title:'+title;return axios.get(req_gemarkung,{headers:authHeader}).then(function(response){var data=response.data.response.docs;//docs is a list\nvar resp_in_list=getResultsList(data);return resp_in_list;});}if(filter==\"3\"){//https://collections.thulb.uni-jena.de/api/v1/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND place_extended_search:\"Jena\"\nvar req_place=API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND place_extended_search:'+title;return axios.get(req_place,{headers:authHeader}).then(function(response){var data=response.data.response.docs;//docs is a list\nvar resp_in_list=getResultsList(data);return resp_in_list;});}};/*\n- Eine Gemarkung hat eine Sammlung von untergeordneten Flurnamen als children\n- Es gibt eine Liste der children der Gemarkung\n- Für jedes Element (flurname) wird ein GET-Request mit ID gesendet\n- Nur einige Merkmale wurden gespeichert\n*/var getChilden=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(childList){var childInfos,i,childID,childReq,childRes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0://console.log(\"RUFEN CHILDREN\");\nchildInfos=[];/*\n  var childImgs=[];\n  for(var i in childList.slice(0,15)){\n    var childID = childList[i].$[\"xlink:title\"];\n    var imgReq = API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND returnId:'+childID;\n    await axios.get(imgReq,{headers:authHeader}).then(function (response){\n      var data = response.data.response.docs;\n\n    }\n  };\n*/_context2.t0=_regeneratorRuntime.keys(childList.slice(0,5));case 2:if((_context2.t1=_context2.t0()).done){_context2.next=14;break;}i=_context2.t1.value;childID=childList[i].$[\"xlink:title\"];childReq=API_URL+'/objects/'+childID;childRes={};//get Images\n_context2.next=9;return axios.get(childReq,{headers:authHeader}).then(function(response){var xml2js=require('react-native-xml2js');var parser=new xml2js.Parser();var dataJS='';parser.parseString(response.data,function(err,detailJSON){dataJS=detailJSON.mycoreobject;//console.log(\"content\");\n//console.log(content);\n//dataJS = content;\n});var content={title:' ',area:' ',evidence:' ',note:' ',parent:' '};try{//metadata[0][\"def.title\"][0].title[0]._\nvar title=dataJS.metadata[0][\"def.title\"][0].title[0]._;content.title=title;}catch(_unused2){}try{var area=dataJS.metadata[0][\"def.area\"][0].area[0]._;content.area=area;}catch(_unused3){}try{var evidence=dataJS.metadata[0][\"def.evidence\"][0].evidence[0]._;content.evidence=evidence;}catch(_unused4){}try{var note=dataJS.metadata[0][\"def.note\"][0].note[0]._;content.note=note;}catch(_unused5){}try{var parent=dataJS.structure[0].parents[0].parent[0].$[\"xlink:href\"];content.parent=parent;}catch(_unused6){}//return resJ;\n//console.log('content');\n//console.log(content);\nchildRes=content;//console.log('chilRes in function');\n//console.log(childRes);\n});case 9:console.log(\"children\");console.log(childRes);childInfos.push(childRes);_context2.next=2;break;case 14:return _context2.abrupt(\"return\",childInfos);case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function getChilden(_x3){return _ref2.apply(this,arguments);};}();/*\nresponse von einer Gemarkung beinhaltet mehrere children\ninformation von children wird mit der funktion getChildren gefunden und gespeichert\n*/var contentDetailGemarkung=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dataJS){var content,childINfos,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"JSONJSON\");console.log(dataJS);content={'title':dataJS.metadata[0][\"def.title\"][0].title[0][\"_\"],//structure[0].derobjects[0].derobject[0].maindoc[0]\n//'img':dataJS.structure[0].derobjects[0].derobject[0].maindoc[0],\n'img':[],'children':[]};try{content.img=dataJS.structure[0].derobjects[0].derobject;//[0].maindoc[0]\n}catch(_unused7){}console.log(\"IMAGE\");console.log(content.img);childINfos=null;_context3.next=9;return getChilden(dataJS.structure[0].children[0].child).then(function(result){console.log(result);childINfos=result;});case 9:content.children=childINfos;result=[];result.push(childINfos);return _context3.abrupt(\"return\",result);case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function contentDetailGemarkung(_x4){return _ref3.apply(this,arguments);};}();/*\nInformationen eines Flurnamen wird gefiltert und gespeichert\n\n*/var contentDetailFlurname=function contentDetailFlurname(dataJS){//console.log(dataJS);\n//console.log(\"SERVER RESPONSE\");\nvar details=[[]];var content={title:' ',area:' ',evidence:' ',note:' ',parent:' ',img:[]};try{//metadata[0][\"def.title\"][0].title[0]._\nvar title=dataJS.metadata[0][\"def.title\"][0].title[0]._;content.title=title;}catch(_unused8){}try{var area=dataJS.metadata[0][\"def.area\"][0].area[0]._;content.area=area;}catch(_unused9){}try{var evidence=dataJS.metadata[0][\"def.evidence\"][0].evidence[0]._;content.evidence=evidence;}catch(_unused10){}try{var note=dataJS.metadata[0][\"def.note\"][0].note[0]._;content.note=note;}catch(_unused11){}try{var parent=dataJS.structure[0].parents[0].parent[0].$[\"xlink:href\"];content.parent=parent;}catch(_unused12){}try{content.img=dataJS.structure[0].derobjects[0].derobject;//[0].maindoc[0]\n}catch(_unused13){}console.log(\"IMAGE\");console.log(content.img);details[0].push(content);return details;};var getInfoDetails=function getInfoDetails(objectID){var req=API_URL+'/objects/'+objectID;return axios.get(req,{headers:authHeader}).then(function(response){var xml2js=require('react-native-xml2js');var parser=new xml2js.Parser();var dataJS='';parser.parseString(response.data,function(err,detailJSON){dataJS=detailJSON.mycoreobject;});//console.log(\"ALL KEYS\");\n//console.log(dataJS);\n//console.log(Object.keys(dataJS.structure));\n//console.log(dataJS.structure['0']);\nvar keys=Object.keys(dataJS.structure['0']);if(keys.includes('children')){var contentG=contentDetailGemarkung(dataJS);//console.log(\"RUECKWERTE\");\n//console.log(contentG);\nreturn contentG;}else{//Flurname\nvar contentF=contentDetailFlurname(dataJS);return contentF;}//console.log(dataJS);\n//var content = contentDetails(dataJS)\n});};export default{searchInfoQuery:searchInfoQuery,getInfoDetails:getInfoDetails};","map":{"version":3,"sources":["/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/src/components/apis/get.service.js"],"names":["axios","token","authHeader","API_URL","keys","getImage","objectID","imgReq","imgL","get","headers","then","response","xml2js","require","parser","Parser","dataJS","parseString","data","err","detailJSON","mycoreobject","structure","derobjects","derobject","console","log","getResultsList","foundObjects","i","length","len","new_data","COLLECTION_URL","VIEW_URL","TIF","maindoc","$","img","push","searchInfoQuery","title","filter","req","docs","resp_in_list","req_flurname","req_gemarkung","req_place","getChilden","childList","childInfos","slice","childID","childReq","childRes","content","area","evidence","note","parent","metadata","_","parents","contentDetailGemarkung","childINfos","children","child","result","contentDetailFlurname","details","getInfoDetails","Object","includes","contentG","contentF"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\n//Infornation von APIs\nconst token=\"cmVzdGFwaS1yZWFkOmRlMjgxMjMyOGIzYTZmODc1NDIyYjM4NzZlMDJiZTM3\"\nconst authHeader={'Authorization': `Basic ${token}`}\nconst API_URL='https://collections.thulb.uni-jena.de/api/v1'\n\n\nconst keys=[\n  'title',\n  'area',\n  'evidence',\n  'note',\n  'parent'\n]\n/*\nAus der Daten werden nur folgende Funktionen eines Ergebnises gespeichert.\n*/\nconst getImage = async (objectID) =>{\n  var imgReq = \"https://collections.thulb.uni-jena.de/api/v1/objects/\"+objectID;\n  var imgL=[];\n  await axios.get(imgReq, {headers:authHeader}).then((response)=>{\n          \n      var xml2js = require('react-native-xml2js');\n      var parser = new xml2js.Parser();\n      var dataJS='';\n      parser.parseString(response.data, function (err, detailJSON) {\n          dataJS = detailJSON.mycoreobject;\n      });\n      \n      try{\n      imgL = dataJS.structure[0].derobjects[0].derobject;\n      }catch{}\n\n      \n      \n  });\n  console.log(\"test image\");\n  console.log(imgL);\n  return imgL;\n};\n\nasync function getResultsList(data){\n\n  const foundObjects=[]\n  for (var i = 0; i < data.length; i++)\n        {\n            var len=0\n            if(data[i]['link']!=null){\n              len=data[i]['link'].length\n            }\n            var new_data={\n                'id':data[i]['id'],\n                'title':data[i]['title'][0],\n                'place':data[i]['place'][0],\n                'gnd':data[i]['gnd'],\n                'link':data[i]['link'],\n                'len':len,\n                'facetObjectType':data[i]['facetObjectType'],\n                \"search_result_link_text\":data[i][\"search_result_link_text\"],\n                'ArchFile_class_001_Label':data[i]['ArchFile_class_001_Label'][1],\n                'collection':'',\n                'img':''\n                \n            }\n            var objectID = new_data['id'];\n            var imgL = []\n            \n            imgL = await getImage(objectID);\n            /*.then(function (res){\n              console.log(\"in function get imageeee\");\n              \n              imgL = res;\n              console.log(imgL);\n              \n            });\n            */\n            if(imgL.length!=0){\n            console.log(\"outside of function\");\n            console.log(imgL[0]);\n            //.$[\"xlink:href\"]\n            var COLLECTION_URL = \"https://collections.thulb.uni-jena.de/rsc/viewer/\" //HisBest_derivate_00024139/Flurnamen_Erfurt_Arnstadt_4605.tif\n            var VIEW_URL = 'https://collections.thulb.uni-jena.de/servlets/MCRTileCombineServlet/MID/';\n            var TIF = imgL[0].maindoc[0];\n\n            new_data['img'] = VIEW_URL+imgL[0].$[\"xlink:href\"]+\"/\"+TIF;\n            new_data['collection'] = COLLECTION_URL+imgL[0].$[\"xlink:href\"]+\"/\"+TIF;\n            }\n            console.log(\"adding to new data\");\n            console.log(new_data.img);\n\n            foundObjects.push(new_data)\n        }\n    return foundObjects\n};\n\n\n/*\nFunktion zum Aufrufen der Daten mit dem gegebenen Title.\nReturn bereits in JSON\nErgebnisse für gesuchten Title werden an Search Komponent gesendet\n*/\nconst searchInfoQuery  = (title, filter) => {\n  console.log(\"search option: \" + filter);\n    if(filter==\"0\"){\n      var req = API_URL+ '/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND title:'+title;\n      return axios.get(req, {headers:authHeader}).then((response)=>{\n        \n          const data = response.data.response.docs; //docs is a list\n          const resp_in_list= getResultsList(data);\n          return resp_in_list;\n      });    \n    }   \n    if(filter==\"1\"){\n      var req_flurname = API_URL+ '/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND facetObjectType:\"Flurkarte\" AND title:'+title;\n      return axios.get(req_flurname, {headers:authHeader}).then((response)=>{\n        \n          const data = response.data.response.docs; //docs is a list\n          const resp_in_list= getResultsList(data);\n          return resp_in_list;\n      });    \n    }\n    if(filter==\"2\"){\n      var req_gemarkung = API_URL+ '/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND facetObjectType:\"Gemarkung\" AND title:'+title;\n      return axios.get(req_gemarkung, {headers:authHeader}).then((response)=>{\n        \n          const data = response.data.response.docs; //docs is a list\n          const resp_in_list= getResultsList(data);\n          return resp_in_list;\n      });    \n    }\n    if(filter==\"3\"){\n      //https://collections.thulb.uni-jena.de/api/v1/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND place_extended_search:\"Jena\"\n      var req_place = API_URL+ '/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND objectType:\"cbu\" AND place_extended_search:'+title;\n      return axios.get(req_place, {headers:authHeader}).then((response)=>{\n        \n          const data = response.data.response.docs; //docs is a list\n          const resp_in_list= getResultsList(data);\n          return resp_in_list;\n      });    \n    }\n};\n\n/*\n- Eine Gemarkung hat eine Sammlung von untergeordneten Flurnamen als children\n- Es gibt eine Liste der children der Gemarkung\n- Für jedes Element (flurname) wird ein GET-Request mit ID gesendet\n- Nur einige Merkmale wurden gespeichert\n*/\n\nconst getChilden= async (childList)=>{\n  //console.log(\"RUFEN CHILDREN\");\n  var childInfos=[];\n  /*\n  var childImgs=[];\n  for(var i in childList.slice(0,15)){\n    var childID = childList[i].$[\"xlink:title\"];\n    var imgReq = API_URL+'/search?wt=json&q=+cbuUnitTypes.actual:(33.0 33.1) AND returnId:'+childID;\n    await axios.get(imgReq,{headers:authHeader}).then(function (response){\n      var data = response.data.response.docs;\n\n    }\n  };\n*/\n  for(var i in childList.slice(0,5)){\n      var childID = childList[i].$[\"xlink:title\"];\n      var childReq = API_URL+'/objects/'+childID;\n      var childRes = {};\n      //get Images\n\n      await axios.get(childReq, {headers:authHeader}).then(function (response) {\n        var xml2js = require('react-native-xml2js');\n        var parser = new xml2js.Parser();\n        var dataJS='';\n        parser.parseString(response.data, function (err, detailJSON) {\n            dataJS = detailJSON.mycoreobject;\n            //console.log(\"content\");\n            //console.log(content);\n            //dataJS = content;\n          });\n          \n        var content={\n          title:' ',\n          area:' ',\n          evidence:' ',\n          note:' ',\n          parent:' '\n        };\n        \n          try{\n            //metadata[0][\"def.title\"][0].title[0]._\n            var title = dataJS.metadata[0][\"def.title\"][0].title[0]._;\n            content.title=title;\n          }catch{}\n        \n          try{\n            var area = dataJS.metadata[0][\"def.area\"][0].area[0]._;\n            content.area=area;\n          }catch{}\n          try{\n            var evidence = dataJS.metadata[0][\"def.evidence\"][0].evidence[0]._;\n            content.evidence=evidence;\n          }catch{}\n          try{\n            var note = dataJS.metadata[0][\"def.note\"][0].note[0]._;\n            content.note=note;\n          }catch{}\n        \n          try{\n            var parent = dataJS.structure[0].parents[0].parent[0].$[\"xlink:href\"];\n            content.parent=parent;\n          }catch{}\n          //return resJ;\n          //console.log('content');\n          //console.log(content);\n          childRes = content;\n          //console.log('chilRes in function');\n          //console.log(childRes);\n          \n        });\n      \n        console.log(\"children\");\n          console.log(childRes);\n          childInfos.push(childRes);\n      }\n      \n  return childInfos\n}\n\n/*\nresponse von einer Gemarkung beinhaltet mehrere children\ninformation von children wird mit der funktion getChildren gefunden und gespeichert\n*/\nconst contentDetailGemarkung= async (dataJS)=>{\n  console.log(\"JSONJSON\");\n  console.log(dataJS);\n  var content={\n      'title':dataJS.metadata[0][\"def.title\"][0].title[0][\"_\"],\n      //structure[0].derobjects[0].derobject[0].maindoc[0]\n      //'img':dataJS.structure[0].derobjects[0].derobject[0].maindoc[0],\n     'img':[],\n      'children': []\n  }\n  \n  try{\n    content.img = dataJS.structure[0].derobjects[0].derobject//[0].maindoc[0]\n  }\n  catch{}\n  console.log(\"IMAGE\");\n  console.log(content.img);\n  var childINfos = null;\n \n \n  await getChilden(dataJS.structure[0].children[0].child).then(function (result){\n    console.log(result);\n    childINfos = result;\n  });\n  \n  content.children = childINfos;\n\n  var result = []\n  result.push(childINfos);\n  return result;\n};\n\n/*\nInformationen eines Flurnamen wird gefiltert und gespeichert\n\n*/\nconst contentDetailFlurname=(dataJS)=>{\n\n  //console.log(dataJS);\n  //console.log(\"SERVER RESPONSE\");\n  \n  const details=[[]];\n  const content={\n    title:' ',\n    area:' ',\n    evidence:' ',\n    note:' ',\n    parent:' ',\n    img:[]\n  };\n  \n  try{\n    //metadata[0][\"def.title\"][0].title[0]._\n    var title = dataJS.metadata[0][\"def.title\"][0].title[0]._;\n    content.title=title;\n  }catch{\n\n  }\n\n  try{\n    var area = dataJS.metadata[0][\"def.area\"][0].area[0]._;\n    content.area=area;\n  }catch{\n\n  }\n\n  try{\n    var evidence = dataJS.metadata[0][\"def.evidence\"][0].evidence[0]._;\n    content.evidence=evidence;\n  }catch{\n\n  }\n\n  try{\n    var note = dataJS.metadata[0][\"def.note\"][0].note[0]._;\n    content.note=note;\n  }catch{\n\n  }\n\n  try{\n    var parent = dataJS.structure[0].parents[0].parent[0].$[\"xlink:href\"];\n    content.parent=parent;\n  }catch{\n\n  }\n\n  try{\n    content.img = dataJS.structure[0].derobjects[0].derobject//[0].maindoc[0]\n  }\n  catch{}\n  console.log(\"IMAGE\");\n  console.log(content.img);\n\n  details[0].push(content);\n  return details;\n};\n\n\nconst getInfoDetails = (objectID) => {\n  var req = API_URL+'/objects/'+objectID;\n  return axios.get(req, {headers:authHeader}).then((response)=>{\n        \n        var xml2js = require('react-native-xml2js');\n        var parser = new xml2js.Parser();\n        var dataJS='';\n        parser.parseString(response.data, function (err, detailJSON) {\n            dataJS = detailJSON.mycoreobject;\n        });\n        //console.log(\"ALL KEYS\");\n        //console.log(dataJS);\n        //console.log(Object.keys(dataJS.structure));\n        //console.log(dataJS.structure['0']);\n        \n        var keys = Object.keys(dataJS.structure['0']);\n\n        if(keys.includes('children')){\n            var contentG = contentDetailGemarkung(dataJS);\n            //console.log(\"RUECKWERTE\");\n            //console.log(contentG);\n            return contentG\n        }\n        else{\n          //Flurname\n            \n            var contentF = contentDetailFlurname(dataJS);\n            return contentF\n        }\n        //console.log(dataJS);\n        //var content = contentDetails(dataJS)\n      \n  });\n};\n\nexport default {\n  searchInfoQuery,\n  getInfoDetails\n};"]},"metadata":{},"sourceType":"module"}