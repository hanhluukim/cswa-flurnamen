{"ast":null,"code":"import _slicedToArray from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/node_modules/@babel/runtime/helpers/esm/createSuper\";import{render}from'react-dom';import React,{Component}from'react';import axios from'axios';//import {Link} from 'react-router-dom';\n//import DropdownButton from 'react-bootstrap/DropdownButton';\n//import Dropdown from 'react-bootstrap/Dropdown';\n//import ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport{MDBCol,MDBBtn,MDBIcon,MDBRow}from\"mdbreact\";import GetService from'../components/apis/get.service';import{MDBTable,MDBTableBody,MDBTableHead}from'mdbreact';import Display from'./Modal';import Form from'react-bootstrap/Form';import Col from'react-bootstrap/Col';import Lightbox from'react-image-lightbox';import\"react-image-lightbox/style.css\";import{useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var foundObjects=[];var requestGetIDs={method:'get',url:'https://collections.thulb.uni-jena.de/api/v1/search?q=+cbuUnitTypes.actual:(33.0%2033.1)%20AND%20objectType:%22cbu%22&rows=50&wt=json',//'https://collections.thulb.uni-jena.de/api/v1/search?q=+cbuUnitTypes.actual:(33.0%20%20%20%20%20%20%20%20%20%2033.1)&wt=json',\nheaders:{'Authorization':'Basic cmVzdGFwaS1yZWFkOmRlMjgxMjMyOGIzYTZmODc1NDIyYjM4NzZlMDJiZTM3'}};var Search=/*#__PURE__*/function(_Component){_inherits(Search,_Component);var _super=_createSuper(Search);//define the constructure of component Search\nfunction Search(props){var _this;_classCallCheck(this,Search);_this=_super.call(this,props);_this.handleInputChange=function(){if(_this.search.value!==''){_this.setState({query:_this.search.value,//based on query will rall results be filtered\n//suggestion durch der Title die Buchstaben aus dem Eingabe erh채lt\nfilterBestand:_this.state.results.filter(function(bestand){return bestand['title'].toLowerCase().includes(_this.state.query.toLowerCase());})});}else{_this.setState({isLoadedForQuery:false});}};_this.handelSelect=function(e){console.log(\"event\"+e.target.value);_this.setState({filterSelect:e.target.value});//console.log(\"choose\" + this.state.filterSelect);\n};_this.getResultsForQuery=function(event){var title=_this.state.query;var filter=_this.state.filterSelect;console.log(title);GetService.searchInfoQuery(title,filter).then(function(result){console.log(\"query\");console.log(_assertThisInitialized(_this));console.log(result);_this.setState({resultsForQuery:result,isLoadedForQuery:true});//this.search.value=\"\";\n});console.log(\"results for query loaded\");};var default_query=\"\";_this.state={query:default_query,idList:[],results:[],filterBestand:[],all:0,//parameters for search of query\nisLoadedForQuery:false,resultsForQuery:[],filterSelect:\"0\"//isOpenImage:false\n//modal\n};_this.handleInputChange=_this.handleInputChange.bind(_assertThisInitialized(_this));return _this;}_createClass(Search,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios(requestGetIDs).then(function(response){//get number of all results\n_this2.setState({all:response.data.response.numFound});var data=response.data.response.docs;//docs is a list\nfor(var i=0;i<data.length;i++){var new_data={'id':data[i]['id'],'title':data[i]['title'][0],//'gnd':data[i]['gnd'],\n'link':data[i]['link']//'facetObjectType':data[i]['facetObjectType'],\n//\"search_result_link_text\":data[i][\"search_result_link_text\"],\n//'ArchFile_class_001_Label':data[i]['ArchFile_class_001_Label'][1],\n};foundObjects.push(new_data);}_this2.setState({results:foundObjects//results: fakeResp\n});}).catch(function(error){console.log(error);});case 2:console.log(\"First Call for Suggestions: loaded\");case 3:case\"end\":return _context.stop();}}},_callee);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;//adding number of results\nvar isFound=this.state.filterBestand.length;var isLoaded=this.state.isLoadedForQuery;var suggestResults;var showResults;var filterSearch;if(isFound&&isLoaded==false){suggestResults=/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{margin:'auto',textAlign:'justify'},id:\"list-suggests\",children:this.state.filterBestand.slice(0,5).map(function(item,index){return/*#__PURE__*/_jsx(SuggestList,_objectSpread({},item),index);})});}var isFoundForQuery=this.state.resultsForQuery.length;if(isLoaded==true){if(isFoundForQuery!==0){showResults=/*#__PURE__*/_jsxs(\"h3\",{id:\"id-number-results\",class:\"text-success\",children:[/*#__PURE__*/_jsx(\"span\",{children:isFoundForQuery}),\" Ergebnis gefunden\"]});}else{showResults=/*#__PURE__*/_jsxs(\"h3\",{id:\"id-number-results\",style:{textAlign:'justify'},class:\"text-danger\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"0\"}),\" Ergebnis gefunden!\"]});}}filterSearch=/*#__PURE__*/_jsx(Form,{center:true,children:['checkbox'].map(function(type){return/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Form.Row,{center:true,style:{marginLeft:'auto',marginRight:'auto'},children:[/*#__PURE__*/_jsx(Form.Group,{as:Col,md:\"4\",children:/*#__PURE__*/_jsx(Form.Check,{defaultChecked:true,type:type,id:\"default-\".concat(type),label:'Flurname'})}),/*#__PURE__*/_jsx(Form.Group,{as:Col,md:\"4\",children:/*#__PURE__*/_jsx(Form.Check,{//disabled\ndefaultChecked:true,type:type,label:'Gemarkung',id:\"disabled-default-\".concat(type)})}),/*#__PURE__*/_jsx(Form.Group,{as:Col,md:\"4\",children:/*#__PURE__*/_jsx(Form.Check,{//disabled\ntype:type,label:'Ort',id:\"disabled-default-\".concat(type)})})]})},\"default-\".concat(type));})});//render HTML\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"Search\",children:[/*#__PURE__*/_jsx(MDBCol,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group md-form form-sm form-1 pl-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group-prepend\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text green lighten-3\",id:\"basic-text1\",children:/*#__PURE__*/_jsx(MDBIcon,{className:\"text-white\",icon:\"search\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text green lighten-3\",children:/*#__PURE__*/_jsxs(\"select\",{className:\"browser-default custom-select\",onChange:this.handelSelect,children:[/*#__PURE__*/_jsx(\"option\",{select:\"selected\",value:\"0\",children:\"optionale Suche\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Flurkarte\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Gemarkung\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"Ort\"})]})})]}),/*#__PURE__*/_jsx(\"input\",{name:\"input-query\",className:\"form-control my-0 py-1\",ref:function ref(input){return _this3.search=input;},onChange:this.handleInputChange//onKeyPress={event=>event.key==\"Enter\" &&this.getResultsForQuery}\n,type:\"text\",placeholder:\"Suchbegriff eingeben und Button dr\\xFCcken\",\"aria-label\":\"Search\"}),/*#__PURE__*/_jsx(MDBBtn,{id:\"id-btn-search\",color:\"green\",onClick:this.getResultsForQuery,children:\"Suchen\"})]})}),suggestResults,showResults,/*#__PURE__*/_jsxs(MDBTable,{id:\"table-results\",className:\"table-result\",children:[/*#__PURE__*/_jsx(MDBTableHead,{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{children:\"GND\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Typ\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Untergeordnete\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Details\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Beispiel\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Kollektion\"})]})}),/*#__PURE__*/_jsx(MDBTableBody,{children:this.state.resultsForQuery.map(function(item,index){return/*#__PURE__*/_jsx(ResultsList,_objectSpread({},item),index);})})]})]});}}]);return Search;}(Component);var ResultsList=function ResultsList(props){//console.log(props);\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isOpen=_useState2[0],setImage=_useState2[1];var objectID=props.id;var title=props.title;console.log(\"result properties\");console.log(props);//let childs = props.link;\nvar isLink=null;if(props.img===\"\"){isLink=false;}else{isLink=true;}//var detailsPage = \"/details:\"+objectID;\n//img[0].$[\"xlink:href\"]\nreturn/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:props['title']}),/*#__PURE__*/_jsx(\"td\",{children:props['place']}),/*#__PURE__*/_jsx(\"td\",{children:props['facetObjectType']}),/*#__PURE__*/_jsx(\"td\",{children:props['len']}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Display,{name:\"modalOpen\",value:[title,objectID]})}),/*#__PURE__*/_jsx(\"td\",{children:isLink?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"photo\",src:props['img'],onClick:function onClick(){return setImage(true);}}),isOpen&&/*#__PURE__*/_jsx(Lightbox,{mainSrc:props['img'],onCloseRequest:function onCloseRequest(){return setImage(false);}})]}):/*#__PURE__*/_jsx(\"p\",{})}),/*#__PURE__*/_jsx(\"td\",{children:isLink?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"a\",{style:{margin:'auto',textAlign:'justify'},href:props['collection'],children:/*#__PURE__*/_jsx(MDBIcon,{icon:\"eye\"})})}):/*#__PURE__*/_jsx(\"p\",{})})]});};var SuggestList=function SuggestList(props){return/*#__PURE__*/_jsx(\"p\",{class:\"p-suggest\",children:props['title']});};export default Search;//\n//<td name=\"details\">\n//<Display name=\"modalOpen\" value={[title,objectID]}/>\n//<Display \n//  objectTitle={props['title']} \n//  objectID={props.id}/>\n//</td>","map":{"version":3,"sources":["/home/miss-luu/Downloads/0_Studium/0_web_client/cswa/cswa-flurnamen/src/components/Search.js"],"names":["render","React","Component","axios","MDBCol","MDBBtn","MDBIcon","MDBRow","GetService","MDBTable","MDBTableBody","MDBTableHead","Display","Form","Col","Lightbox","useState","foundObjects","requestGetIDs","method","url","headers","Search","props","handleInputChange","search","value","setState","query","filterBestand","state","results","filter","bestand","toLowerCase","includes","isLoadedForQuery","handelSelect","e","console","log","target","filterSelect","getResultsForQuery","event","title","searchInfoQuery","then","result","resultsForQuery","default_query","idList","all","bind","response","data","numFound","docs","i","length","new_data","push","catch","error","isFound","isLoaded","suggestResults","showResults","filterSearch","margin","textAlign","slice","map","item","index","isFoundForQuery","type","marginLeft","marginRight","input","ResultsList","isOpen","setImage","objectID","id","isLink","img","SuggestList"],"mappings":"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","sourcesContent":["import { render } from 'react-dom';\nimport React, { Component} from 'react';\nimport axios from 'axios';\n//import {Link} from 'react-router-dom';\n//import DropdownButton from 'react-bootstrap/DropdownButton';\n//import Dropdown from 'react-bootstrap/Dropdown';\n//import ButtonGroup from 'react-bootstrap/ButtonGroup';\n\nimport { MDBCol, MDBBtn, MDBIcon, MDBRow} from \"mdbreact\";\nimport GetService from '../components/apis/get.service';\nimport { MDBTable, MDBTableBody, MDBTableHead } from 'mdbreact';\nimport Display from './Modal';\nimport Form from 'react-bootstrap/Form';\nimport Col from 'react-bootstrap/Col';\nimport Lightbox from 'react-image-lightbox';\nimport \"react-image-lightbox/style.css\";\nimport { useState } from 'react';\n\n\nvar foundObjects=[]\n\n\nvar requestGetIDs = {\n    method: 'get',\n    url: 'https://collections.thulb.uni-jena.de/api/v1/search?q=+cbuUnitTypes.actual:(33.0%2033.1)%20AND%20objectType:%22cbu%22&rows=50&wt=json',\n    //'https://collections.thulb.uni-jena.de/api/v1/search?q=+cbuUnitTypes.actual:(33.0%20%20%20%20%20%20%20%20%20%2033.1)&wt=json',\n    headers: { \n      'Authorization': 'Basic cmVzdGFwaS1yZWFkOmRlMjgxMjMyOGIzYTZmODc1NDIyYjM4NzZlMDJiZTM3'\n    }\n  };\n\nclass Search extends Component {\n\n  //define the constructure of component Search\n\n  constructor(props) {\n    super(props);\n\n    const default_query=\"\";\n\n    this.state = {\n        query: default_query,\n        idList: [],\n        results: [],\n        filterBestand:[],\n        all: 0,\n        //parameters for search of query\n        isLoadedForQuery: false,\n        resultsForQuery: [],\n        filterSelect: \"0\",\n        //isOpenImage:false\n        //modal\n    };\n    this.handleInputChange = this.handleInputChange.bind(this);\n    \n  }\n\n  async componentDidMount() {\n    //first request to get all IDs\n    await axios(requestGetIDs).then((response)=>{\n        //get number of all results\n        this.setState({\n          all: response.data.response.numFound\n        })\n\n        const data = response.data.response.docs; //docs is a list\n        \n        for (var i = 0; i < data.length; i++)\n        {\n            var new_data={\n                'id':data[i]['id'],\n                'title':data[i]['title'][0],\n                \n                //'gnd':data[i]['gnd'],\n                'link':data[i]['link'],\n                //'facetObjectType':data[i]['facetObjectType'],\n                //\"search_result_link_text\":data[i][\"search_result_link_text\"],\n                //'ArchFile_class_001_Label':data[i]['ArchFile_class_001_Label'][1],\n                \n            }\n            foundObjects.push(new_data)\n        }\n       \n        this.setState({\n            results:foundObjects\n            //results: fakeResp\n        });\n      })\n      .catch((error)=>{\n        console.log(error);\n      });\n      console.log(\"First Call for Suggestions: loaded\");\n  }\n\n\n  handleInputChange = () => {\n      if(this.search.value!==''){\n      this.setState({\n      query: this.search.value,\n      //based on query will rall results be filtered\n      //suggestion durch der Title die Buchstaben aus dem Eingabe erh채lt\n      filterBestand:this.state.results.filter((bestand)=>bestand['title'].toLowerCase().includes(this.state.query.toLowerCase()))\n      })\n    }\n    else{\n      this.setState({\n        isLoadedForQuery:false\n      })\n    }\n\n  }\n\n  handelSelect = (e) =>{\n    console.log(\"event\" + e.target.value);\n    this.setState({\n      filterSelect: e.target.value\n    });\n    //console.log(\"choose\" + this.state.filterSelect);\n  }\n  /*\n  Daten f체r eingebene Anfrage aufrufen\n  Response wird in dem State resultForQuery gespeichert\n  */\n  getResultsForQuery =(event) =>{\n    const title = this.state.query;\n    const filter = this.state.filterSelect;\n    console.log(title);\n    GetService.searchInfoQuery(title, filter).then((result)=>{\n      console.log(\"query\");\n      console.log(this);\n      console.log(result);\n      this.setState({\n        resultsForQuery:result,\n        isLoadedForQuery:true,\n      \n      });\n      //this.search.value=\"\";\n\n    });\n    console.log(\"results for query loaded\");\n    \n  }\n\n  render() {\n    //adding number of results\n    var isFound = this.state.filterBestand.length;\n    \n    var isLoaded = this.state.isLoadedForQuery;\n\n    let suggestResults;\n    let showResults;\n    let filterSearch;\n    \n    \n   if(isFound && isLoaded==false){\n\n     suggestResults=<div className=\"card\" style={{margin:'auto', textAlign:'justify'}} id=\"list-suggests\">\n     {this.state.filterBestand.slice(0,5).map((item, index) => <SuggestList key={index} {...item} />)}\n     </div>\n   }\n    var isFoundForQuery = this.state.resultsForQuery.length;\n    if(isLoaded==true){\n      if(isFoundForQuery!==0){\n        showResults=<h3 id=\"id-number-results\" class=\"text-success\"><span>{isFoundForQuery}</span> Ergebnis gefunden</h3>\n      }\n      else{\n        showResults=<h3 id=\"id-number-results\" style={{textAlign:'justify'}}class=\"text-danger\"><span>0</span> Ergebnis gefunden!</h3>\n      }\n    }\n\n    filterSearch=<Form center>\n    {['checkbox'].map((type) => (\n      <div key={`default-${type}`} className=\"mb-3\">\n        <Form.Row center style={{marginLeft:'auto', marginRight:'auto'}}>\n        <Form.Group as={Col} md=\"4\">\n          <Form.Check\n            defaultChecked={true}\n            type={type}\n            id={`default-${type}`}\n            label={'Flurname'}\n          />\n        </Form.Group>\n        <Form.Group as={Col} md=\"4\">\n          <Form.Check\n            //disabled\n            defaultChecked={true}\n            type={type}\n            label={'Gemarkung'}\n            id={`disabled-default-${type}`}\n          />\n        </Form.Group>\n        <Form.Group as={Col} md=\"4\">\n          <Form.Check\n            //disabled\n            type={type}\n            label={'Ort'}\n            id={`disabled-default-${type}`}\n          />\n        </Form.Group>\n        </Form.Row>\n      </div>\n    ))}\n</Form>\n\n\n    //render HTML\n    return (\n      <div className=\"Search\">\n        \n        <MDBCol>\n            <div className=\"input-group md-form form-sm form-1 pl-0\">\n                <div className=\"input-group-prepend\">\n\n                <span className=\"input-group-text green lighten-3\" id=\"basic-text1\">\n                    <MDBIcon className=\"text-white\" icon=\"search\" />\n                </span>\n                <span className=\"input-group-text green lighten-3\">\n                  <select className=\"browser-default custom-select\" onChange={this.handelSelect}>\n                    <option select='selected' value=\"0\">optionale Suche</option>\n                    <option value=\"1\">Flurkarte</option>\n                    <option value=\"2\">Gemarkung</option>\n                    <option value=\"3\">Ort</option>\n                  </select>\n                </span>\n                </div>\n                  \n                    <input name=\"input-query\"\n                        className=\"form-control my-0 py-1\" \n                        ref={input => this.search = input}\n                        onChange={this.handleInputChange}\n                        //onKeyPress={event=>event.key==\"Enter\" &&this.getResultsForQuery}\n                        type=\"text\" \n                        placeholder=\"Suchbegriff eingeben und Button dr체cken\" \n                        aria-label=\"Search\" />\n                    <MDBBtn id=\"id-btn-search\" color=\"green\" onClick={this.getResultsForQuery}>Suchen</MDBBtn>\n                 \n              </div>\n        </MDBCol>\n\n        {/*filterSearch*/}\n        {/*Suggessions*/}        \n        {suggestResults}\n        \n\n        {showResults}\n        \n        <MDBTable id=\"table-results\" className=\"table-result\">\n          <MDBTableHead>\n            <tr>\n              <th>Title</th>\n              <th>GND</th>\n              <th>Typ</th>\n              <th>Untergeordnete</th>\n              \n              <th>Details</th> \n              <th>Beispiel</th>\n              <th>Kollektion</th>\n            </tr>\n          </MDBTableHead>\n          <MDBTableBody>\n              {this.state.resultsForQuery.map((item, index) => <ResultsList key={index} {...item} />)}\n              {/*{this.state.resultsForQuery.map((item, index) => <SearchResult key={index} item={item} />)*/}\n          </MDBTableBody>\n\n        </MDBTable> \n      </div>\n    );\n  }  \n}\n\n\nconst ResultsList=(props)=>{\n  //console.log(props);\n\n  const [isOpen, setImage] = useState(false);\n  \n  const objectID=props.id;\n  const title = props.title;\n\n\n  console.log(\"result properties\");\n  console.log(props);\n\n  //let childs = props.link;\n  let isLink = null;\n  if (props.img===\"\"){\n    isLink=false;\n  }\n  else{\n    isLink=true;\n  }\n\n  //var detailsPage = \"/details:\"+objectID;\n  //img[0].$[\"xlink:href\"]\n\n  return (\n  <tr>\n    <td>{props['title']}</td>\n    <td>{props['place']}</td>\n    <td>{props['facetObjectType']}</td>\n    <td>{props['len']}</td>\n    \n    <td>\n    <Display name=\"modalOpen\" value={[title,objectID]}/>\n    {/*\n        <Link\n        class=\"btn btn-success\"\n        to={detailsPage}\n        >Anzeige</Link>\n    */}\n    </td> \n    <td>\n      {isLink ? (\n      <div>\n        <img className=\"photo\" src={props['img']} onClick={() => setImage(true)}/>\n        \n        {isOpen && (\n        <Lightbox\n            mainSrc={props['img']}\n            onCloseRequest={() => setImage(false)}\n          />\n        )}\n      </div>\n      )\n      :(<p></p>)\n      }\n    </td>\n    <td>\n      {isLink ? (\n      <div>\n       \n        <a style={{margin:'auto', textAlign:'justify'}} href={props['collection']}><MDBIcon icon=\"eye\"/></a>\n        \n      </div>\n      )\n      :(<p></p>)\n      }\n    </td>\n\n  </tr> \n  );\n};\n\nconst SuggestList=(props)=>(\n    <p class=\"p-suggest\">\n    {props['title']}\n    </p>\n);\n\n\n\nexport default Search;\n\n//\n//<td name=\"details\">\n//<Display name=\"modalOpen\" value={[title,objectID]}/>\n//<Display \n//  objectTitle={props['title']} \n//  objectID={props.id}/>\n//</td>\n"]},"metadata":{},"sourceType":"module"}